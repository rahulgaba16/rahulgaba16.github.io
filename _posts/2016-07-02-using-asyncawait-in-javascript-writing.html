---
layout: post
title: Using Async/Await in JavaScript - Writing async code as if it is synchronous
date: '2016-07-02T14:20:00.000-07:00'
author: rahul gaba
tags: 
modified_time: '2016-07-02T14:27:08.463-07:00'
blogger_id: tag:blogger.com,1999:blog-4968645659124036844.post-7882723908890673455
blogger_orig_url: http://gabarahul.blogspot.com/2016/07/using-asyncawait-in-javascript-writing.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><h2 style="text-align: left;"><span style="font-family: inherit;">Intro</span></h2><div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: left;"><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">I recently came across the async/await feature of javascript in a&nbsp;meet-up&nbsp;and was blown away after&nbsp;knowing its power.</span></div><div style="text-align: left;"><span style="font-family: inherit;"><br /></span></div><h2 style="text-align: left;"><span style="font-family: inherit;">What is async/await?</span></h2><div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">Its nothing but a simple and easy to understand approach towards the handling the asynchronous events(callbacks/promises) in javascript.<br /><br />We all have heard of the callback hell in JavaScript (If you have not heard of it, have a look at&nbsp;<a href="http://callbackhell.com/">callbackhell.com</a>). Then promises came into picture. Promises are great and very easy to manage. But still people do get in trouble while handling promises. Async/Await can be used to handle promises.</span></div><div><span style="font-family: inherit;"><br /></span></div><div><h2><span style="font-family: inherit;">Why use async/await?</span></h2></div><div><span style="font-family: inherit;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span></span><span style="font-family: inherit;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">What if I tell you that you can write your async code as if it was synchronous. That would be awesome right?&nbsp;</span><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">Well that's exactly what async/await do, obviously without blocking the javascript main thread.</span></span><br /><span style="font-family: inherit;"><br /></span><h2 style="text-align: left;"><span style="font-family: inherit;">How to use async/await?</span></h2></div><div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">It will be easier to show you using an example</span></div><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">We will start with mocking an API response using setTimeout method.</span><br /><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span> <!-- HTML generated using hilite.me --><br /><div style="background: #333333; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">function</span> getResponse() {<br />   <span style="color: #008800;"><b>let</b></span> promise <span style="color: #ffffff;">=</span> <span style="color: #008800; font-weight: bold;">new</span> Promise(<span style="color: #008800; font-weight: bold;">function</span>(resolve, reject) {<br />     <span style="color: #007020;">window</span>.setTimeout(<span style="color: #008800; font-weight: bold;">function</span>() {<br />       resolve(<span style="background-color: #607D8B;">'done!'</span>);<br />     },<span style="color: #0000dd; font-weight: bold;">2000</span>);<br />   });<br />   <span style="color: #008800; font-weight: bold;">return</span> promise;<br />}<br /></pre></div><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span></div><div><span style="font-family: inherit;">Now, the conventional way of Handling this promise would be something like this:</span><br /><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span> <!-- HTML generated using hilite.me --><br /><div style="background: #333333; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;">getResponse().then(<span style="color: #008800; font-weight: bold;">function</span>(done) {<br />  console.log(<span style="background-color: #607D8B;">'response from promise'</span>); <span style="color: #888888;"></span><br />});<br /></pre></div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">We will do the same using Async/Await now.</span><br /><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span> <!-- HTML generated using hilite.me --><br /><div style="background: #333333; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;">async <span style="color: #008800; font-weight: bold;">function</span> logResponse() {<br />  <span style="color: #008800; font-weight: bold;">let</span> awaitedResponse <span style="color: #ffffff;">=</span> await getResponse(); <span style="color: #888888;">// awaitedResponse will get the value<br />//only after the promise in getResponse() gets resolved.</span><br />  console.log(<span style="background-color: #607D8B;">'awaitedResponse is '</span>,awaitedResponse);<br />}<br /><br />logResponse();<br />console.log(<span style="background-color: #607D8B;">'Do everything else'</span>);<br /></pre></div><span style="font-family: inherit;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">As you just saw, it is working like any normal function and the code works like a synchronous code.</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">Also note that the code is non-blocking. The thread will print '</span><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">Do everything else' before printing the response.</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">And the best part is that you can use a non-promise value in await too.</span></span><br /><span style="font-family: inherit;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">eg: you could do the following inside an async function:&nbsp;</span></span><br /><pre style="line-height: 125%; margin: 0;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span></pre><!-- HTML generated using hilite.me --><br /><div style="background: #333333; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #008800; font-weight: bold;">let</span> awaitedResponse <span style="color: #ffffff;">=</span> await <span style="background-color: #607D8B;">'some value'</span>;<br /></pre></div><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span><span style="font-family: inherit;">and the will work just fine.</span><br /><div><span style="font-family: inherit;"><br /></span></div><span style="font-family: inherit;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span></span><br /><h2 style="text-align: left;"><span style="font-family: inherit;">Verdict</span></h2><div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">The code looks much more readable and manageable now.</span></div><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">Do have a look at&nbsp;<span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><a href="http://rossboucher.com/await">rossboucher.com/await</a> to know more about&nbsp;</span><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;">Async/Await</span></span></div></div><div><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span></div><div style="text-align: left;"><span style="font-family: &quot;helvetica neue&quot; , &quot;arial&quot; , &quot;helvetica&quot; , sans-serif;"><br /></span></div></div></div>